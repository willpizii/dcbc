{% extends "base.html" %}

{% block content %}

<div class="container py-4">
    <h3 class="mb-4">Boat Time</h3>

    <div class="col-md-6 mb-4">
        <input type="text" id="tagSearch" class="form-control" placeholder="Filter by Tag" oninput="filter()">
    </div>
    <table class="table table-bordered table-hover table-striped">
        <thead>
            <tr>
                <th scope="col" width="40%">Boat</th>
                <th scope="col" width="60%">Tags</th>
            </tr>
        </thead>
        <tbody id="userTableBody">
            {% for boat in boats_list %}
                <tr>
                    <td> <a href={{ url_for("edit_boat", boat=boat.name) }}>{{boat.name}}</a> </td>
                    <td>
                        {% for tag in boat.tags %}
                            <div class='btn btn-secondary'> {{tag}} </div>
                        {% endfor %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        function filter() {
            var searchQuery = document.getElementById('tagSearch').value.toLowerCase();
            var rows = document.querySelectorAll('#userTableBody tr');

            rows.forEach(function(row) {
                // Check search query
                var tagsCells = row.querySelectorAll('td:nth-child(2) div'); // Each tag is inside a div
                var tagMatch = Array.from(tagsCells).some(function(cell) {
                    return cell.textContent.toLowerCase().includes(searchQuery);
                });

                if (tagMatch) {
                    row.style.display = ''; // Show row if it matches the search
                } else {
                    row.style.display = 'none'; // Hide row
                }
            });
        }

        document.getElementById('tagSearch').addEventListener('input', filter);

        filter(); // Initial call to filter on page load
    });
</script>
{% endblock %}
